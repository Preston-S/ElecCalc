import{f as k,e as N,a as I}from"../chunks/NmPVEbss.js";import{i as J}from"../chunks/MCpOFegH.js";import{q as ge,an as oe,ah as he,a2 as we,b4 as Se,b5 as Ie,w as G,x as xe,aj as K,b6 as ve,$ as H,ak as j,a as e,al as Q,ap as s,am as v,s as q,b7 as ke,aq as a,u as S,b8 as qe,ar as Ue,as as Re,at as Le,aI as ie,ao as De}from"../chunks/C7s_4A4C.js";import{s as x}from"../chunks/BErm2lkx.js";import{m as He,h as Ce,l as Ee,t as Ae}from"../chunks/Bn6f7_XN.js";import{r as ue}from"../chunks/0lKmbFWX.js";import{b as ce}from"../chunks/BuigJWDy.js";import{s as U,a as V,d as Pe,b as M}from"../chunks/BnFVzCsZ.js";import{g as Te}from"../chunks/Di97F_EY.js";import{i as de}from"../chunks/ZSZ7rd2r.js";import{e as me}from"../chunks/HbtteHjj.js";import{t as ne,a as Fe}from"../chunks/Xx4LWZxO.js";import{f as Ne}from"../chunks/BviiYr3T.js";import{f as le}from"../chunks/BI5KFv7B.js";import{P as je}from"../chunks/B1w9WJdy.js";function pe(t,u,r=!1){if(t.multiple){if(u==null)return;if(!we(u))return Se();for(var n of t.options)n.selected=u.includes(T(n));return}for(n of t.options){var _=T(n);if(Ie(_,u)){n.selected=!0;return}}(!r||u!==void 0)&&(t.selectedIndex=-1)}function Me(t){var u=new MutationObserver(()=>{pe(t,t.__value)});u.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),he(()=>{u.disconnect()})}function Oe(t,u,r=u){var n=new WeakSet,_=!0;ge(t,"change",m=>{var c=m?"[selected]":":checked",l;if(t.multiple)l=[].map.call(t.querySelectorAll(c),T);else{var b=t.querySelector(c)??t.querySelector("option:not([disabled])");l=b&&T(b)}r(l),G!==null&&n.add(G)}),oe(()=>{var m=u();if(t===document.activeElement){var c=xe??G;if(n.has(c))return}if(pe(t,m,_),_&&m===void 0){var l=t.querySelector(":checked");l!==null&&(m=T(l),r(m))}t.__value=m,_=!1}),Me(t)}function T(t){return"__value"in t?t.__value:t.value}var We=k("<option disabled selected>Add materials in settings</option>"),Be=k("<option> </option>"),Ge=k('<div class="item-selector svelte-1ss7k5a"><select class="svelte-1ss7k5a"><!><!></select> <input type="number" min="1" class="svelte-1ss7k5a"/> <button class="svelte-1ss7k5a">Add</button></div>');function Je(t,u){K(u,!1);const r=()=>U(He,"$materials",_),n=()=>U(c,"$estimateItems",_),[_,m]=V(),c=ve("estimateItems");let l=H(r().length>0?r()[0].id:null),b=H(1);function R(){if(!e(l)){alert("Please select an item.");return}const i=r().find(d=>d.id===e(l));if(!i)return;const z=n().findIndex(d=>d.id===e(l));z>-1?(Pe(c,S(n)[z].quantity+=e(b),S(n)),M(c,[...n()])):M(c,[...n(),{...i,quantity:e(b)}]),q(b,1)}J();var p=Ge(),o=s(p);j(()=>{e(l),ke(()=>{r()})});var f=s(o);{var $=i=>{var z=We();I(i,z)};de(f,i=>{r().length===0&&i($)})}var g=v(f);me(g,1,r,i=>i.id,(i,z)=>{var d=Be(),L=s(d,!0);a(d);var h={};j(()=>{x(L,e(z).name),h!==(h=e(z).id)&&(d.value=(d.__value=e(z).id)??"")}),I(i,d)}),a(o);var y=v(o,2);ue(y);var w=v(y,2);a(p),Oe(o,()=>e(l),i=>q(l,i)),ce(y,()=>e(b),i=>q(b,i)),N("click",w,R),I(t,p),Q(),m()}var Ke=k('<p class="empty-message svelte-302u75">No items added yet.</p>'),Qe=k('<li class="svelte-302u75"><div class="item-details"><span class="item-name svelte-302u75"> </span> <span class="item-qty svelte-302u75"> </span></div> <div class="item-actions svelte-302u75"><span class="item-total svelte-302u75"> </span> <button class="remove-btn svelte-302u75">&times;</button></div></li>'),Ve=k('<ul class="item-list svelte-302u75"></ul>'),Xe=k('<div class="item-list-container svelte-302u75"><!></div>');function Ye(t,u){K(u,!1);const r=()=>U(m,"$estimateItems",n),[n,_]=V(),m=ve("estimateItems");function c(o){M(m,r().filter(f=>f.id!==o))}J();var l=Xe(),b=s(l);{var R=o=>{var f=Ke();I(o,f)},p=o=>{var f=Ve();me(f,13,r,$=>$.id,($,g)=>{var y=Qe(),w=s(y),i=s(w),z=s(i,!0);a(i);var d=v(i,2),L=s(d);a(d),a(w);var h=v(w,2),C=s(h),E=s(C,!0);a(C);var O=v(C,2);a(h),a(y),j((A,P)=>{x(z,e(g).name),x(L,`${e(g).quantity??""} Ã— ${A??""}`),x(E,P)},[()=>e(g).price.toLocaleString("en-US",{style:"currency",currency:"USD"}),()=>(e(g).quantity*e(g).price).toLocaleString("en-US",{style:"currency",currency:"USD"})]),N("click",O,()=>c(e(g).id)),ne(1,y,()=>le),ne(2,y,()=>le),Fe(y,()=>Ne,()=>({duration:300})),I($,y)}),a(f),I(o,f)};de(b,o=>{r().length===0?o(R):o(p,!1)})}a(l),I(t,l),Q(),_()}var Ze=k('<!> <div class="container svelte-z2duwz"><main><div class="section input-section svelte-z2duwz"><label for="hours" class="svelte-z2duwz">Estimated Labor Hours</label> <input id="hours" type="number" step="0.5" placeholder="0" class="svelte-z2duwz"/></div> <hr class="svelte-z2duwz"/> <div class="section svelte-z2duwz"><!></div> <div class="item-list-section svelte-z2duwz"><!></div> <div class="summary-section svelte-z2duwz"><h2 class="svelte-z2duwz">Running Total</h2> <div class="summary-item svelte-z2duwz"><span>Subtotal</span> <span> </span></div> <div class="summary-item total svelte-z2duwz"><span>Total (incl. labor & tax)</span> <span> </span></div></div> <div class="button-container svelte-z2duwz"><button class="cta-button desktop-cta svelte-z2duwz">Review Final Receipt</button></div></main></div> <div class="mobile-summary svelte-z2duwz"><div class="mobile-totals svelte-z2duwz"><div class="mobile-sub svelte-z2duwz"> </div> <div class="mobile-total svelte-z2duwz"> </div></div> <button class="cta-button mobile-cta svelte-z2duwz">Review</button></div>',1);function ft(t,u){K(u,!1);const r=()=>U(b,"$estimateItems",c),n=()=>U(R,"$estimatedHours",c),_=()=>U(Ee,"$laborRate",c),m=()=>U(Ae,"$taxRate",c),[c,l]=V(),b=ie([]),R=ie(0);qe("estimateItems",b);let p=H(0),o=H(0),f=H(0),$=H(0);function g(){Te("receipt",{state:{items:r(),subtotal:e(p),laborCost:e(o),tax:e(f),total:e($),hours:n()}})}Ue(()=>(e(p),r(),e(o),n(),_(),e(f),m()),()=>{q(p,r().reduce((D,F)=>D+F.price*F.quantity,0)),q(o,n()*_()),q(f,(e(p)+e(o))*m()),q($,e(p)+e(o)+e(f))}),Re(),J();var y=Ze();Ce("z2duwz",D=>{oe(()=>{De.title="Create Estimate"})});var w=Le(y);je(w,{title:"New Estimate",backHref:"/"});var i=v(w,2),z=s(i),d=s(z),L=v(s(d),2);ue(L),a(d);var h=v(d,4),C=s(h);Je(C,{}),a(h);var E=v(h,2),O=s(E);Ye(O,{}),a(E);var A=v(E,2),P=v(s(A),2),X=v(s(P),2),fe=s(X,!0);a(X),a(P);var Y=v(P,2),Z=v(s(Y),2),_e=s(Z,!0);a(Z),a(Y),a(A);var ee=v(A,2),te=s(ee);a(ee),a(z),a(i);var ae=v(i,2),W=s(ae),B=s(W),be=s(B);a(B);var se=v(B,2),ye=s(se);a(se),a(W);var re=v(W,2);a(ae),j((D,F,ze,$e)=>{x(fe,D),x(_e,F),te.disabled=(r(),S(()=>r().length===0)),x(be,`Subtotal: ${ze??""}`),x(ye,`Total: ${$e??""}`),re.disabled=(r(),S(()=>r().length===0))},[()=>(e(p),S(()=>e(p).toLocaleString("en-US",{style:"currency",currency:"USD"}))),()=>(e($),S(()=>e($).toLocaleString("en-US",{style:"currency",currency:"USD"}))),()=>(e(p),S(()=>e(p).toLocaleString("en-US",{style:"currency",currency:"USD"}))),()=>(e($),S(()=>e($).toLocaleString("en-US",{style:"currency",currency:"USD"})))]),ce(L,n,D=>M(R,D)),N("click",te,g),N("click",re,g),I(t,y),Q(),l()}export{ft as component};
