import{f as k,s as L,a as x,e as Y}from"../chunks/DYQIaMgs.js";import{i as Q}from"../chunks/CTVf-Cpm.js";import{m as Ie,o as J,al as de,q as xe,Y as ke,aK as qe,aL as Re,ar as Ue,aa as X,aM as me,V as A,ai as s,af as N,a as e,aN as Le,ah as v,aj as a,s as D,ae as Z,u as U,aO as we,ab as De,ac as Ce,ad as Ee,aI as oe,ag as He}from"../chunks/DOyfLbYF.js";import{i as ee}from"../chunks/CBJRxKJI.js";import{m as Ae,h as Ne,l as Te,t as Fe}from"../chunks/BfN4VpFQ.js";import{r as pe,a as Me}from"../chunks/BeMnpFuH.js";import{b as _e}from"../chunks/_X_RwZcR.js";import{a as C,s as te,d as Oe,b as j}from"../chunks/DYW5j25u.js";import{g as Ye}from"../chunks/CUag5-oj.js";import{e as fe}from"../chunks/7ZlRXt7D.js";import{t as ve,a as je}from"../chunks/Cf-Q6Mza.js";import{f as Be}from"../chunks/BviiYr3T.js";import{f as ue}from"../chunks/BI5KFv7B.js";import{b as ce}from"../chunks/DW30XHLL.js";function be(t,u,r=!1){if(t.multiple){if(u==null)return;if(!ke(u))return qe();for(var i of t.options)i.selected=u.includes(F(i));return}for(i of t.options){var d=F(i);if(Re(d,u)){i.selected=!0;return}}(!r||u!==void 0)&&(t.selectedIndex=-1)}function Ge(t){var u=new MutationObserver(()=>{be(t,t.__value)});u.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ue(()=>{u.disconnect()})}function Ke(t,u,r=u){var i=new WeakSet,d=!0;Ie(t,"change",m=>{var c=m?"[selected]":":checked",l;if(t.multiple)l=[].map.call(t.querySelectorAll(c),F);else{var b=t.querySelector(c)??t.querySelector("option:not([disabled])");l=b&&F(b)}r(l),J!==null&&i.add(J)}),de(()=>{var m=u();if(t===document.activeElement){var c=xe??J;if(i.has(c))return}if(be(t,m,d),d&&m===void 0){var l=t.querySelector(":checked");l!==null&&(m=F(l),r(m))}t.__value=m,d=!1}),Ge(t)}function F(t){return"__value"in t?t.__value:t.value}var Pe=k("<option disabled selected>Add materials in settings</option>"),Ve=k("<option> </option>"),We=k('<div class="item-selector svelte-1ss7k5a"><select class="svelte-1ss7k5a"><!><!></select> <input type="number" min="1" class="svelte-1ss7k5a"/> <button class="svelte-1ss7k5a">Add</button></div>');function ze(t,u){X(u,!1);const r=()=>C(Ae,"$materials",d),i=()=>C(c,"$estimateItems",d),[d,m]=te(),c=me("estimateItems");let l=A(r().length>0?r()[0].id:null),b=A(1);function E(){if(!e(l)){alert("Please select an item.");return}const n=r().find(f=>f.id===e(l));if(!n)return;const y=i().findIndex(f=>f.id===e(l));y>-1?(Oe(c,U(i)[y].quantity+=e(b),U(i)),j(c,[...i()])):j(c,[...i(),{...n,quantity:e(b)}]),D(b,1)}Q();var p=We(),o=s(p);N(()=>{e(l),Le(()=>{r()})});var _=s(o);{var g=n=>{var y=Pe();x(n,y)};ee(_,n=>{r().length===0&&n(g)})}var S=v(_);fe(S,1,r,n=>n.id,(n,y)=>{var f=Ve(),H=s(f,!0);a(f);var R={};N(()=>{L(H,e(y).name),R!==(R=e(y).id)&&(f.value=(f.__value=e(y).id)??"")}),x(n,f)}),a(o);var h=v(o,2);pe(h);var q=v(h,2);a(p),Ke(o,()=>e(l),n=>D(l,n)),_e(h,()=>e(b),n=>D(b,n)),Y("click",q,E),x(t,p),Z(),m()}var Je=k('<p class="empty-message svelte-302u75">No items added yet.</p>'),Qe=k('<li class="svelte-302u75"><div class="item-details"><span class="item-name svelte-302u75"> </span> <span class="item-qty svelte-302u75"> </span></div> <div class="item-actions svelte-302u75"><span class="item-total svelte-302u75"> </span> <button class="remove-btn svelte-302u75">&times;</button></div></li>'),Xe=k('<ul class="item-list svelte-302u75"></ul>'),Ze=k('<div class="item-list-container svelte-302u75"><!></div>');function et(t,u){X(u,!1);const r=()=>C(m,"$estimateItems",i),[i,d]=te(),m=me("estimateItems");function c(o){j(m,r().filter(_=>_.id!==o))}Q();var l=Ze(),b=s(l);{var E=o=>{var _=Je();x(o,_)},p=o=>{var _=Xe();fe(_,13,r,g=>g.id,(g,S)=>{var h=Qe(),q=s(h),n=s(q),y=s(n,!0);a(n);var f=v(n,2),H=s(f);a(f),a(q);var R=v(q,2),w=s(R),B=s(w,!0);a(w);var M=v(w,2);a(R),a(h),N((G,O)=>{L(y,e(S).name),L(H,`${e(S).quantity??""} Ã— ${G??""}`),L(B,O)},[()=>e(S).price.toLocaleString("en-US",{style:"currency",currency:"USD"}),()=>(e(S).quantity*e(S).price).toLocaleString("en-US",{style:"currency",currency:"USD"})]),Y("click",M,()=>c(e(S).id)),ve(1,h,()=>ue),ve(2,h,()=>ue),je(h,()=>Be,()=>({duration:300})),x(g,h)}),a(_),x(o,_)};ee(b,o=>{r().length===0?o(E):o(p,!1)})}a(l),x(t,l),Z(),d()}var tt=k('<div class="prompt-container svelte-1uha8ag"><h1 class="svelte-1uha8ag">Set Your Labor Rate</h1> <p class="svelte-1uha8ag">Before you can create an estimate, you need to set your hourly labor rate.</p> <a class="cta-button svelte-1uha8ag">Go to Settings</a></div>'),at=k('<main class="svelte-1uha8ag"><div class="section input-section svelte-1uha8ag"><label for="hours" class="svelte-1uha8ag">Estimated Labor Hours</label> <input id="hours" type="number" step="0.5" placeholder="0" class="svelte-1uha8ag"/></div> <hr class="svelte-1uha8ag"/> <div class="section svelte-1uha8ag"><!></div> <div class="item-list-section svelte-1uha8ag"><!></div> <div class="summary-section svelte-1uha8ag"><h2 class="svelte-1uha8ag">Running Total</h2> <div class="summary-item svelte-1uha8ag"><span>Subtotal</span> <span> </span></div> <div class="summary-item total svelte-1uha8ag"><span>Total (incl. labor & tax)</span> <span> </span></div></div> <div class="button-container svelte-1uha8ag"><button class="cta-button desktop-cta svelte-1uha8ag">Review Final Receipt</button></div></main>'),st=k('<div class="container svelte-1uha8ag"><!></div> <div class="mobile-summary svelte-1uha8ag"><div class="mobile-totals svelte-1uha8ag"><div class="mobile-sub svelte-1uha8ag"> </div> <div class="mobile-total svelte-1uha8ag"> </div></div> <button class="cta-button mobile-cta svelte-1uha8ag">Review</button></div>',1);function ht(t,u){X(u,!1);const r=()=>C(b,"$estimateItems",c),i=()=>C(E,"$estimatedHours",c),d=()=>C(Te,"$laborRate",c),m=()=>C(Fe,"$taxRate",c),[c,l]=te(),b=oe([]),E=oe(0);we("estimateItems",b);let p=A(0),o=A(0),_=A(0),g=A(0);function S(){Ye(`${ce}/receipt`,{state:{items:r(),subtotal:e(p),laborCost:e(o),tax:e(_),total:e(g),hours:i()}})}De(()=>(e(p),r(),e(o),i(),d(),e(_),m()),()=>{D(p,r().reduce((I,$)=>I+$.price*$.quantity,0)),D(o,i()*d()),D(_,(e(p)+e(o))*m()),D(g,e(p)+e(o)+e(_))}),Ce(),Q();var h=st();Ne("1uha8ag",I=>{de(()=>{He.title="New Estimate - Electrical Calculator"})});var q=Ee(h),n=s(q);{var y=I=>{var $=tt(),T=v(s($),4);a($),N(()=>Me(T,"href",`${ce??""}/settings`)),x(I,$)},f=I=>{var $=at(),T=s($),ae=v(s(T),2);pe(ae),a(T);var K=v(T,4),he=s(K);ze(he,{}),a(K);var P=v(K,2),ge=s(P);et(ge,{}),a(P);var V=v(P,2),W=v(s(V),2),se=v(s(W),2),ye=s(se,!0);a(se),a(W);var re=v(W,2),ie=v(s(re),2),$e=s(ie,!0);a(ie),a(re),a(V);var ne=v(V,2),le=s(ne);a(ne),a($),N((z,Se)=>{L(ye,z),L($e,Se),le.disabled=(r(),U(()=>r().length===0))},[()=>(e(p),U(()=>e(p).toLocaleString("en-US",{style:"currency",currency:"USD"}))),()=>(e(g),U(()=>e(g).toLocaleString("en-US",{style:"currency",currency:"USD"})))]),_e(ae,i,z=>j(E,z)),Y("click",le,S),x(I,$)};ee(n,I=>{!d()||d()===0?I(y):I(f,!1)})}a(q);var H=v(q,2),R=s(H),w=s(R),B=s(w);a(w);var M=v(w,2),G=s(M);a(M),a(R);var O=v(R,2);a(H),N((I,$)=>{L(B,`Subtotal: ${I??""}`),L(G,`Total: ${$??""}`),O.disabled=(r(),U(()=>r().length===0))},[()=>(e(p),U(()=>e(p).toLocaleString("en-US",{style:"currency",currency:"USD"}))),()=>(e(g),U(()=>e(g).toLocaleString("en-US",{style:"currency",currency:"USD"})))]),Y("click",O,S),x(t,h),Z(),l()}export{ht as component};
