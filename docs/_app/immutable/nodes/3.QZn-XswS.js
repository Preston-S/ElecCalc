import{f as S,e as N,a as I}from"../chunks/BnLQ-DHN.js";import{i as O}from"../chunks/bKSdJTgH.js";import{ao as ue,a2 as ae,X as ve,J as ce,aR as de,aS as me,i as M,ar as pe,_ as Q,aT as se,F as U,$ as W,x as e,a0 as V,a4 as n,a1 as i,Y as g,aU as fe,a5 as s,b as A,aV as _e,aW as be,aX as ze,as as Z,a3 as he}from"../chunks/DabYpkku.js";import{s as w}from"../chunks/DuV4064y.js";import{h as ye}from"../chunks/DqcH-oxp.js";import{b as re,m as $e,r as ie,l as Ie,t as ge}from"../chunks/CnPqX9nC.js";import{s as x,a as Y,c as we,b as X}from"../chunks/D553h821.js";import{g as xe}from"../chunks/uAj77J7G.js";import{e as ne}from"../chunks/IXDt0NTB.js";import{i as Se}from"../chunks/CE1OkSbe.js";import{t as ee,a as ke}from"../chunks/CyI70dUi.js";import{f as qe}from"../chunks/BviiYr3T.js";import{f as te}from"../chunks/BI5KFv7B.js";function le(t,v,r=!1){if(t.multiple){if(v==null)return;if(!ce(v))return de();for(var a of t.options)a.selected=v.includes(F(a));return}for(a of t.options){var _=F(a);if(me(_,v)){a.selected=!0;return}}(!r||v!==void 0)&&(t.selectedIndex=-1)}function Re(t){var v=new MutationObserver(()=>{le(t,t.__value)});v.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ve(()=>{v.disconnect()})}function Ue(t,v,r=v){var a=new WeakSet,_=!0;ue(t,"change",f=>{var d=f?"[selected]":":checked",l;if(t.multiple)l=[].map.call(t.querySelectorAll(d),F);else{var b=t.querySelector(d)??t.querySelector("option:not([disabled])");l=b&&F(b)}r(l),M!==null&&a.add(M)}),ae(()=>{var f=v();if(t===document.activeElement){var d=pe??M;if(a.has(d))return}if(le(t,f,_),_&&f===void 0){var l=t.querySelector(":checked");l!==null&&(f=F(l),r(f))}t.__value=f,_=!1}),Re(t)}function F(t){return"__value"in t?t.__value:t.value}var Ce=S("<option> </option>"),Le=S('<div class="item-selector svelte-1ss7k5a"><select class="svelte-1ss7k5a"></select> <input type="number" min="1" class="svelte-1ss7k5a"/> <button class="svelte-1ss7k5a">Add Item</button></div>');function De(t,v){Q(v,!1);const r=()=>x($e,"$materials",_),a=()=>x(d,"$estimateItems",_),[_,f]=Y(),d=se("estimateItems");let l=U(r().length>0?r()[0].id:null),b=U(1);function k(){if(!e(l)){alert("Please select an item.");return}const p=r().find(u=>u.id===e(l));if(!p)return;const c=a().findIndex(u=>u.id===e(l));c>-1?(we(d,A(a)[c].quantity+=e(b),A(a)),X(d,[...a()])):X(d,[...a(),{...p,quantity:e(b)}]),g(b,1)}O();var z=Le(),o=n(z);W(()=>{e(l),fe(()=>{r()})}),ne(o,5,r,p=>p.id,(p,c)=>{var u=Ce(),h=n(u,!0);s(u);var $={};W(()=>{w(h,e(c).name),$!==($=e(c).id)&&(u.value=(u.__value=e(c).id)??"")}),I(p,u)}),s(o);var m=i(o,2);ie(m);var y=i(m,2);s(z),Ue(o,()=>e(l),p=>g(l,p)),re(m,()=>e(b),p=>g(b,p)),N("click",y,k),I(t,z),V(),f()}var Ee=S('<p class="empty-message svelte-302u75">No items added yet.</p>'),He=S('<li class="list-item svelte-302u75"><span class="item-name svelte-302u75"> </span> <span class="item-qty svelte-302u75"> </span> <span class="item-price svelte-302u75"> </span> <span class="item-total svelte-302u75"> </span> <button class="remove-btn svelte-302u75">&times;</button></li>'),Te=S('<ul class="item-list svelte-302u75"><li class="list-header svelte-302u75"><span>Item</span> <span>Qty</span> <span>Price</span> <span>Total</span> <span></span></li> <!></ul>'),Ae=S('<div class="item-list-container svelte-302u75"><!></div>');function Fe(t,v){Q(v,!1);const r=()=>x(f,"$estimateItems",a),[a,_]=Y(),f=se("estimateItems");function d(o){X(f,r().filter(m=>m.id!==o))}O();var l=Ae(),b=n(l);{var k=o=>{var m=Ee();I(o,m)},z=o=>{var m=Te(),y=i(n(m),2);ne(y,9,r,p=>p.id,(p,c)=>{var u=He(),h=n(u),$=n(h,!0);s(h);var q=i(h,2),C=n(q,!0);s(q);var L=i(q,2),D=n(L,!0);s(L);var E=i(L,2),H=n(E,!0);s(E);var T=i(E,2);s(u),W((J,B)=>{w($,e(c).name),w(C,e(c).quantity),w(D,J),w(H,B)},[()=>e(c).price.toLocaleString("en-US",{style:"currency",currency:"USD"}),()=>(e(c).quantity*e(c).price).toLocaleString("en-US",{style:"currency",currency:"USD"})]),N("click",T,()=>d(e(c).id)),ee(1,u,()=>te),ee(2,u,()=>te),ke(u,()=>qe,()=>({duration:300})),I(p,u)}),s(m),I(o,m)};Se(b,o=>{r().length===0?o(k):o(z,!1)})}s(l),I(t,l),V(),_()}var Je=S('<div class="container svelte-z2duwz"><header><a href="/" class="back-link svelte-z2duwz">&larr; Back to Settings</a> <h1 class="svelte-z2duwz">Create Estimate</h1></header> <main><div class="card svelte-z2duwz"><h2 class="svelte-z2duwz">Job Details</h2> <div class="form-group svelte-z2duwz"><label for="hours" class="svelte-z2duwz">Estimated Labor Hours</label> <input id="hours" type="number" step="0.5" class="svelte-z2duwz"/></div></div> <div class="card svelte-z2duwz"><h2 class="svelte-z2duwz">Add Items</h2> <!></div> <div class="card svelte-z2duwz"><h2 class="svelte-z2duwz">Current Items</h2> <!></div> <div class="card summary svelte-z2duwz"><h2 class="svelte-z2duwz">Running Total</h2> <div class="summary-item svelte-z2duwz"><span>Subtotal</span> <span> </span></div> <div class="summary-item total svelte-z2duwz"><span>Total (incl. labor & tax)</span> <span> </span></div></div> <button class="cta-button svelte-z2duwz">Review Final Receipt</button></main></div>');function Ze(t,v){Q(v,!1);const r=()=>x(b,"$estimateItems",d),a=()=>x(k,"$estimatedHours",d),_=()=>x(Ie,"$laborRate",d),f=()=>x(ge,"$taxRate",d),[d,l]=Y(),b=Z([]),k=Z(0);_e("estimateItems",b);let z=U(0),o=U(0),m=U(0),y=U(0);function p(){xe("/receipt",{state:{items:r(),subtotal:e(z),laborCost:e(o),tax:e(m),total:e(y),hours:a()}})}be(()=>(e(z),r(),e(o),a(),_(),e(m),f()),()=>{g(z,r().reduce((R,P)=>R+P.price*P.quantity,0)),g(o,a()*_()),g(m,(e(z)+e(o))*f()),g(y,e(z)+e(o)+e(m))}),ze(),O();var c=Je();ye("z2duwz",R=>{ae(()=>{he.title="Create Estimate"})});var u=i(n(c),2),h=n(u),$=i(n(h),2),q=i(n($),2);ie(q),s($),s(h);var C=i(h,2),L=i(n(C),2);De(L,{}),s(C);var D=i(C,2),E=i(n(D),2);Fe(E,{}),s(D);var H=i(D,2),T=i(n(H),2),J=i(n(T),2),B=n(J,!0);s(J),s(T);var j=i(T,2),G=i(n(j),2),oe=n(G,!0);s(G),s(j),s(H);var K=i(H,2);s(u),s(c),W((R,P)=>{w(B,R),w(oe,P),K.disabled=(r(),A(()=>r().length===0))},[()=>(e(z),A(()=>e(z).toLocaleString("en-US",{style:"currency",currency:"USD"}))),()=>(e(y),A(()=>e(y).toLocaleString("en-US",{style:"currency",currency:"USD"})))]),re(q,a,R=>X(k,R)),N("click",K,p),I(t,c),V(),l()}export{Ze as component};
